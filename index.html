<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema di Gestione Team - React/Firebase</title>
    <!-- Caricamento di Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Caricamento delle librerie React e ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- FIX: Cambiato il CDN di Babel a una versione più stabile e ampiamente supportata -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/6.26.0/babel.min.js"></script>
    
    <!-- Configurazione Font Inter -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
    </style>
</head>
<body>
    <div id="root" class="min-h-screen flex items-center justify-center p-4">
        <!-- L'applicazione React verrà renderizzata qui -->
    </div>

    <!-- Definizione delle variabili globali Firebase/Canvas per l'uso nello script Babel -->
    <script>
        // Le variabili globali vengono riassegnate per essere accessibili nello scope globale
        const APP_ID = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const FIREBASE_CONFIG = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};
        const INITIAL_AUTH_TOKEN = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
    </script>

    <!-- Caricamento dei moduli Firebase (modulare V9+) -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
        import { getFirestore, collection, onSnapshot, doc, addDoc, updateDoc, deleteDoc, serverTimestamp, setLogLevel } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
        
        // Assegna le funzioni Firebase al window object per renderle accessibili allo script type="text/babel"
        window.firebase = { 
            initializeApp, 
            getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged,
            getFirestore, collection, onSnapshot, doc, addDoc, updateDoc, deleteDoc, serverTimestamp, setLogLevel 
        };
        
        // Variabile di stato per segnalare che i moduli sono stati caricati (Cruciale per il polling in App)
        window.firebaseReady = true;

        // Questo script non fa nient'altro, solo carica le funzioni globalmente.
    </script>
    
    <!-- Script principale React/JSX -->
    <script type="text/babel">
        const { useState, useEffect, useCallback } = React;

        // Definizione delle funzioni Firebase globali come variabili (saranno definite in window.firebase)
        let initializeApp, getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged, 
            getFirestore, collection, onSnapshot, doc, addDoc, updateDoc, deleteDoc, serverTimestamp, setLogLevel;

        // Simulazione delle icone Lucide (devono essere definite o rimosse se non disponibili)
        const Icon = ({ name, className }) => <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"></circle><text x="50%" y="50%" dominantBaseline="middle" textAnchor="middle" fontSize="10" fill="currentColor">{name[0]}</text></svg>;

        const Users = (props) => <Icon name="U" {...props} />;
        const UserPlus = (props) => <Icon name="P" {...props} />;
        const X = (props) => <Icon name="X" {...props} />;
        const Check = (props) => <Icon name="C" {...props} />;
        const Eye = (props) => <Icon name="E" {...props} />;
        const EyeOff = (props) => <Icon name="O" {...props} />;
        const Trash2 = (props) => <Icon name="T" {...props} />;
        const Loader2 = (props) => <Icon name="L" {...props} />;
        const Zap = (props) => <Icon name="Z" {...props} />;


        const ruoliDisponibili = ["Attaccante", "Centrocampista", "Difensore", "Portiere", "Allenatore"];
        
        // Uso delle variabili globali definite sopra
        const APP_ID_ = APP_ID; // Renaming per evitare conflitti
        const FIREBASE_CONFIG_ = FIREBASE_CONFIG;
        const INITIAL_AUTH_TOKEN_ = INITIAL_AUTH_TOKEN;

        // Funzione Helper per formattare la data (opzionale)
        const formatDate = (timestamp) => {
            if (!timestamp) return 'N/A';
            if (timestamp.toDate) return timestamp.toDate().toLocaleDateString('it-IT');
            return new Date(timestamp.seconds * 1000).toLocaleDateString('it-IT');
        };

        // Componente di Messaggio (per sostituire alert/confirm)
        const MessageBox = ({ message, onClose }) => {
            if (!message) return null;
            return (
                <div className="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50 p-4">
                    <div className="bg-white p-6 rounded-xl shadow-2xl w-full max-w-sm text-center">
                        <p className="text-lg font-semibold text-gray-800 mb-4">{message}</p>
                        <button
                            onClick={onClose}
                            className="bg-indigo-600 text-white py-2 px-4 rounded-lg hover:bg-indigo-700 transition-colors"
                        >
                            Chiudi
                        </button>
                    </div>
                </div>
            );
        };

        // Componente Principale
        const App = () => {
            const [squadra, setSquadra] = useState([]);
            const [candidature, setCandidature] = useState([]);
            const [nuovoNomeCandidato, setNuovoNomeCandidato] = useState('');
            const [nuovoRuoloCandidato, setNuovoRuoloCandidato] = useState(ruoliDisponibili[0]);
            
            // Stati di Firebase e Autenticazione
            const [db, setDb] = useState(null);
            const [auth, setAuth] = useState(null);
            const [userId, setUserId] = useState(null);
            const [loading, setLoading] = useState(true);
            const [isAuthReady, setIsAuthReady] = useState(false);
            
            // Stati di UI
            const [errorMessage, setErrorMessage] = useState(null); 
            const [userMessage, setUserMessage] = useState(null); 

            const setMessage = (msg) => {
                console.log("User Feedback:", msg);
                setUserMessage(msg);
            };

            // --- 1. Logica di Inizializzazione Firebase e Autenticazione (con Polling) ---
            useEffect(() => {
                // Funzione per controllare se le dipendenze Firebase sono state caricate
                const checkFirebase = () => {
                    // Controlla la flag impostata dallo script type="module" e l'oggetto globale
                    if (window.firebaseReady && window.firebase) {
                        try {
                            // Destrutturazione locale delle funzioni Firebase
                            ({ initializeApp, getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged, 
                            getFirestore, collection, onSnapshot, doc, addDoc, updateDoc, deleteDoc, serverTimestamp, setLogLevel } = window.firebase);
                            
                            setLogLevel('debug'); // Impostazioni per il logging di Firestore (utile per il debug)

                            const firebaseConfig = FIREBASE_CONFIG_;
                            if (Object.keys(firebaseConfig).length === 0) {
                                throw new Error("Configurazione Firebase non trovata.");
                            }

                            const app = initializeApp(firebaseConfig);
                            const authInstance = getAuth(app);
                            const dbInstance = getFirestore(app);

                            setDb(dbInstance);
                            setAuth(authInstance);

                            const initialAuthToken = INITIAL_AUTH_TOKEN_;

                            // Tentativo di autenticazione iniziale
                            const signIn = async () => {
                                try {
                                    if (initialAuthToken) {
                                        await signInWithCustomToken(authInstance, initialAuthToken);
                                    } else {
                                        await signInAnonymously(authInstance);
                                    }
                                } catch (error) {
                                    console.error("Errore di autenticazione iniziale:", error);
                                }
                            };
                            signIn();

                            // Listener per lo stato di autenticazione
                            const unsubscribe = onAuthStateChanged(authInstance, user => {
                                if (user) {
                                    setUserId(user.uid);
                                    console.log("Autenticazione riuscita. UID:", user.uid);
                                } else {
                                    // Fallback se onAuthStateChanged non riceve un utente dopo i tentativi
                                    setUserId('unauth-' + crypto.randomUUID());
                                    console.log("Autenticazione anonima/fallita. Generato ID locale.");
                                }
                                setIsAuthReady(true);
                                setLoading(false);
                            });

                            return () => unsubscribe();
                        } catch (error) {
                            console.error("Errore CRITICO nell'inizializzazione React/Firebase:", error);
                            setErrorMessage(`Errore CRITICO di inizializzazione: ${error.message}. Controlla i log della console.`);
                            setLoading(false);
                        }
                    } else if (Date.now() - startTime > 5000) { // Timeout di 5 secondi
                         setErrorMessage("Errore: Le librerie Firebase (type='module') non sono state caricate dopo 5 secondi. Controlla la console per errori MIME/CORS.");
                         setLoading(false);
                    } else {
                        setTimeout(checkFirebase, 50); // Riprova dopo 50ms
                    }
                };
                
                const startTime = Date.now();
                checkFirebase();
                
                // Cleanup non necessaria qui dato il pattern di polling/timeout
                return () => {}; 
            }, []);

            // --- 2. Logica di Caricamento Dati in Real-Time (onSnapshot) ---
            useEffect(() => {
                if (!isAuthReady || !db || !userId) return;

                // Percorsi nel database (Public Data per una lista di squadra condivisa)
                const getCollectionPath = (name) => collection(db, `artifacts/${APP_ID_}/public/data/${name}`);
                const candidatureRef = getCollectionPath('candidature');
                const squadraRef = getCollectionPath('squadra');

                // Candidature Listener
                const unsubscribeCandidature = onSnapshot(candidatureRef, (snapshot) => {
                    const newCandidature = snapshot.docs.map(doc => ({
                        ...doc.data(),
                        id: doc.id
                    })).sort((a, b) => (b.timestamp?.seconds || 0) - (a.timestamp?.seconds || 0)); 
                    setCandidature(newCandidature);
                }, (error) => {
                    console.error("Firestore Candidature Listener Error:", error);
                    setErrorMessage(`Errore caricamento candidature: ${error.message}`);
                });

                // Squadra Listener
                const unsubscribeSquadra = onSnapshot(squadraRef, (snapshot) => {
                    const newSquadra = snapshot.docs.map(doc => ({
                        ...doc.data(),
                        id: doc.id
                    })).sort((a, b) => (a.nome || '').localeCompare(b.nome || '')); 
                    setSquadra(newSquadra);
                }, (error) => {
                    console.error("Firestore Squadra Listener Error:", error);
                    setErrorMessage(`Errore caricamento squadra: ${error.message}`);
                });

                return () => {
                    unsubscribeCandidature();
                    unsubscribeSquadra();
                };
            }, [isAuthReady, db, userId]); // Dipende da quando Firebase e Auth sono pronti

            // Funzione per aggiungere un NUOVO CANDIDATO
            const addCandidatura = useCallback(async () => {
                if (nuovoNomeCandidato.trim() === '' || !db || !isAuthReady) return;

                const candidatureRef = collection(db, `artifacts/${APP_ID_}/public/data/candidature`);

                const newCandidato = {
                    nome: nuovoNomeCandidato.trim(),
                    ruoloDesiderato: nuovoRuoloCandidato,
                    timestamp: serverTimestamp(),
                    candidatoId: userId, // Per tracciare chi ha inviato la candidatura
                };
                
                try {
                    await addDoc(candidatureRef, newCandidato);
                    setNuovoNomeCandidato('');
                    setNuovoRuoloCandidato(ruoliDisponibili[0]);
                    setMessage(`Candidatura di ${nuovoNomeCandidato.trim()} inviata con successo.`);
                } catch (error) {
                    console.error("Error adding candidature: ", error);
                    setErrorMessage(`Errore nell'invio della candidatura: ${error.message}`);
                }
            }, [nuovoNomeCandidato, nuovoRuoloCandidato, db, isAuthReady, userId]);

            // Funzione per accettare una CANDIDATURA 
            const accettaCandidato = useCallback(async (candidatoId) => {
                if (!db || !isAuthReady) return;
                
                const candidato = candidature.find(c => c.id === candidatoId);
                if (!candidato) return;

                const candidaturaDocRef = doc(db, `artifacts/${APP_ID_}/public/data/candidature`, candidatoId);
                const squadraRef = collection(db, `artifacts/${APP_ID_}/public/data/squadra`);
                
                try {
                    // 1. Aggiungi alla squadra (come nuovo documento)
                    const newMembro = {
                        nome: candidato.nome,
                        ruolo: candidato.ruoloDesiderato,
                        attivo: true,
                        timestamp: serverTimestamp(),
                    };
                    await addDoc(squadraRef, newMembro);

                    // 2. Rimuovi dalle candidature
                    await deleteDoc(candidaturaDocRef);
                    setMessage(`Candidato ${candidato.nome} accettato e aggiunto alla squadra.`);

                } catch (error) {
                    console.error("Error accepting candidate: ", error);
                    setErrorMessage(`Errore nell'accettazione del candidato: ${error.message}`);
                }
            }, [candidature, db, isAuthReady]);

            // Funzione per rifiutare una CANDIDATURA 
            const rifiutaCandidato = useCallback(async (candidatoId) => {
                if (!db || !isAuthReady) return;

                const candidato = candidature.find(c => c.id === candidatoId);
                const candidaturaDocRef = doc(db, `artifacts/${APP_ID_}/public/data/candidature`, candidatoId);
                
                try {
                    await deleteDoc(candidaturaDocRef);
                    setMessage(`Candidatura di ${candidato?.nome || 'un candidato'} rifiutata.`);
                } catch (error) {
                    console.error("Error refusing candidate: ", error);
                    setErrorMessage(`Errore nel rifiuto della candidatura: ${error.message}`);
                }
            }, [candidature, db, isAuthReady]);

            // Funzione per attivare/disattivare un membro della SQUADRA 
            const toggleAttivo = useCallback(async (membroId, currentAttivo) => {
                if (!db || !isAuthReady) return;
                
                const membroDocRef = doc(db, `artifacts/${APP_ID_}/public/data/squadra`, membroId);
                
                try {
                    await updateDoc(membroDocRef, { attivo: !currentAttivo });
                    setMessage(`Stato membro aggiornato a ${!currentAttivo ? 'Attivo' : 'Inattivo'}.`);
                } catch (error) {
                    console.error("Error toggling active status: ", error);
                    setErrorMessage(`Errore nell'aggiornamento dello stato: ${error.message}`);
                }
            }, [db, isAuthReady]);

            // Funzione per rimuovere un membro dalla SQUADRA 
            const rimuoviMembro = useCallback(async (membroId) => {
                if (!db || !isAuthReady) return;

                const membroDocRef = doc(db, `artifacts/${APP_ID_}/public/data/squadra`, membroId);

                try {
                    await deleteDoc(membroDocRef);
                    setMessage('Membro rimosso dalla squadra.');
                } catch (error) {
                    console.error("Error removing member: ", error);
                    setErrorMessage(`Errore nella rimozione del membro: ${error.message}`);
                }
            }, [db, isAuthReady]);
            
            
            // --- Render di Caricamento/Errore ---
            if (loading) {
                return (
                    <div className="flex flex-col items-center justify-center min-h-screen bg-gray-50 p-4">
                        <Loader2 className="h-12 w-12 text-indigo-500 animate-spin" />
                        <p className="mt-4 text-indigo-600 font-semibold">Caricamento servizi e autenticazione...</p>
                        {errorMessage && (
                            <div className="mt-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg max-w-md text-center shadow-lg">
                                <p className='font-bold'>Errore Critico</p>
                                <p>{errorMessage}</p>
                            </div>
                        )}
                    </div>
                );
            }
            
            // Render di errore CRITICO dopo il caricamento
            if (errorMessage && !isAuthReady) {
                 return (
                    <div className="flex items-center justify-center min-h-screen bg-gray-50">
                        <div className="bg-red-100 border-l-4 border-red-500 text-red-700 p-8 rounded-xl shadow-2xl max-w-lg" role="alert">
                            <p className="font-bold text-xl mb-2 flex items-center"><Zap className='mr-2 h-6 w-6'/> Errore Critico di Avvio</p>
                            <p>{errorMessage}</p>
                            <p className="mt-3 text-sm text-red-600">L'app React/Firebase non è stata in grado di inizializzarsi correttamente.</p>
                        </div>
                    </div>
                 );
            }

            // --- Render dell'applicazione principale ---
            return (
                <div className="bg-white shadow-2xl rounded-2xl p-6 md:p-10 w-full max-w-6xl transition-all duration-300">
                    {/* Il MessageBox gestisce i messaggi di successo o gli errori di runtime */}
                    <MessageBox 
                        message={userMessage} 
                        onClose={() => setUserMessage(null)} 
                    />
                    
                    <h1 className="text-4xl font-extrabold text-indigo-800 mb-2 text-center">
                        Sistema di Gestione Team
                    </h1>
                    <p className="text-sm text-center text-gray-500 mb-6">
                        ID App: <span className="font-mono text-xs bg-gray-100 p-1 rounded">{APP_ID_}</span> | 
                        ID Utente: <span className="font-mono text-xs bg-gray-100 p-1 rounded">{userId || 'N/A'}</span>
                    </p>
                    
                    {/* Contenitore Flessibile per le Due Sezioni */}
                    <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        
                        {/* -------------------- SEZIONE 1: GESTIONE CANDIDATURE -------------------- */}
                        <div className="bg-yellow-50 p-6 rounded-xl shadow-lg border border-yellow-200">
                            <h2 className="text-2xl font-bold text-yellow-800 mb-4 flex items-center">
                                <UserPlus className="mr-2 h-6 w-6"/> Gestione Candidature ({candidature.length})
                            </h2>

                            {/* Form per nuova candidatura */}
                            <div className="mb-6 p-4 bg-white rounded-lg border border-yellow-100 shadow-inner">
                                <h3 className="text-lg font-semibold text-yellow-700 mb-3 border-b pb-2 border-yellow-100">Invia Nuova Candidatura</h3>
                                <div className="flex flex-col sm:flex-row gap-3">
                                    <input
                                        type="text"
                                        placeholder="Nome Candidato"
                                        value={nuovoNomeCandidato}
                                        onChange={(e) => setNuovoNomeCandidato(e.target.value)}
                                        className="flex-1 p-3 border border-yellow-300 rounded-lg focus:ring-4 focus:ring-yellow-500/50 transition-shadow outline-none"
                                    />
                                    <select
                                        value={nuovoRuoloCandidato}
                                        onChange={(e) => setNuovoRuoloCandidato(e.target.value)}
                                        className="p-3 border border-yellow-300 rounded-lg bg-white appearance-none cursor-pointer"
                                    >
                                        {ruoliDisponibili.map(r => (
                                            <option key={r} value={r}>{r}</option>
                                        ))}
                                    </select>
                                    <button
                                        onClick={addCandidatura}
                                        className="bg-yellow-500 text-white font-semibold py-3 px-5 rounded-lg hover:bg-yellow-600 transition-colors shadow-lg shadow-yellow-500/50 active:shadow-md disabled:opacity-50 flex items-center justify-center"
                                        disabled={!isAuthReady || nuovoNomeCandidato.trim() === ''}
                                    >
                                        <UserPlus className='h-5 w-5 mr-2'/> Invia
                                    </button>
                                </div>
                            </div>

                            {/* Lista Candidature */}
                            <div className="space-y-3 max-h-96 overflow-y-auto pr-2">
                                {candidature.length === 0 ? (
                                    <p className="text-center text-gray-500 italic p-4 bg-white rounded-lg border border-yellow-100">Nessuna candidatura in attesa.</p>
                                ) : (
                                    candidature.map((candidato) => (
                                        <div
                                            key={candidato.id}
                                            className="flex items-center justify-between p-4 rounded-xl shadow-sm bg-white border border-yellow-200 hover:shadow-md transition-all"
                                        >
                                            <div className="flex-1 min-w-0">
                                                <p className="font-bold text-gray-800 truncate">{candidato.nome}</p>
                                                <p className="text-sm text-gray-500">
                                                    Ruolo: <span className="font-medium text-yellow-700">{candidato.ruoloDesiderato}</span>
                                                    <span className='ml-3 text-xs'>({formatDate(candidato.timestamp)})</span>
                                                </p>
                                            </div>
                                            <div className="flex space-x-2 ml-4">
                                                <button
                                                    onClick={() => accettaCandidato(candidato.id)}
                                                    className="bg-green-500 text-white p-2 rounded-full hover:bg-green-600 transition-colors shadow-md disabled:opacity-50"
                                                    title="Accetta e aggiungi alla Squadra"
                                                    disabled={!isAuthReady}
                                                >
                                                    <Check className='h-5 w-5'/>
                                                </button>
                                                <button
                                                    onClick={() => rifiutaCandidato(candidato.id)}
                                                    className="bg-red-500 text-white p-2 rounded-full hover:bg-red-600 transition-colors shadow-md disabled:opacity-50"
                                                    title="Rifiuta Candidatura"
                                                    disabled={!isAuthReady}
                                                >
                                                    <X className='h-5 w-5'/>
                                                </button>
                                            </div>
                                        </div>
                                    ))
                                )}
                            </div>
                        </div>

                        {/* -------------------- SEZIONE 2: SQUADRA ATTIVA -------------------- */}
                        <div className="bg-indigo-50 p-6 rounded-xl shadow-lg border border-indigo-200">
                            <h2 className="text-2xl font-bold text-indigo-800 mb-6 flex items-center">
                                <Users className="mr-2 h-6 w-6"/> Squadra Attiva ({squadra.length})
                            </h2>

                            {/* Lista Membri Squadra */}
                            <div className="space-y-3 max-h-96 overflow-y-auto pr-2">
                                {squadra.length === 0 ? (
                                    <p className="text-center text-gray-500 italic p-4 bg-white rounded-lg border border-indigo-100">La squadra non ha membri attivi.</p>
                                ) : (
                                    squadra.map((membro) => (
                                        <div
                                            key={membro.id}
                                            className={`flex items-center justify-between p-4 rounded-xl shadow-md transition-all duration-300 ${
                                                membro.attivo ? 'bg-white border-l-4 border-green-500' : 'bg-gray-200 border-l-4 border-gray-400 opacity-90'
                                            }`}
                                        >
                                            <div className="flex-1 min-w-0">
                                                <p className={`font-bold text-lg truncate ${membro.attivo ? 'text-indigo-800' : 'text-gray-600'}`}>
                                                    {membro.nome}
                                                </p>
                                                <p className="text-sm text-gray-500">{membro.ruolo}</p>
                                            </div>
                                            <div className="flex space-x-3 ml-4 items-center">
                                                <span className={`px-3 py-1 text-xs font-medium rounded-full min-w-[70px] text-center ${membro.attivo ? 'bg-green-500 text-white' : 'bg-gray-400 text-white'}`}>
                                                    {membro.attivo ? 'Attivo' : 'Inattivo'}
                                                </span>
                                                <button
                                                    onClick={() => toggleAttivo(membro.id, membro.attivo)}
                                                    className={`text-white p-2 rounded-full text-sm shadow-md transition-colors disabled:opacity-50 ${
                                                        membro.attivo ? 'bg-yellow-500 hover:bg-yellow-600' : 'bg-indigo-500 hover:bg-indigo-600'
                                                    }`}
                                                    title={membro.attivo ? 'Disattiva Membro' : 'Attiva Membro'}
                                                    disabled={!isAuthReady}
                                                >
                                                    {membro.attivo ? <EyeOff className='h-4 w-4'/> : <Eye className='h-4 w-4'/>}
                                                </button>
                                                <button
                                                    onClick={() => rimuoviMembro(membro.id)}
                                                    className="text-white p-2 rounded-full text-sm bg-red-400 hover:bg-red-500 transition-colors shadow-md disabled:opacity-50"
                                                    title="Rimuovi Definitivamente"
                                                    disabled={!isAuthReady}
                                                >
                                                    <Trash2 className='h-4 w-4'/>
                                                </button>
                                            </div>
                                        </div>
                                    ))
                                )}
                            </div>
                        </div>

                    </div>
                    
                </div>
            );
        }

        // Renderizza l'applicazione nel div con id="root"
        // Controllo minimale per assicurarsi che React e ReactDOM siano disponibili
        if (typeof React !== 'undefined' && typeof ReactDOM !== 'undefined') {
            ReactDOM.render(<App />, document.getElementById('root'));
        } else {
            console.error("ERRORE CRITICO: React o ReactDOM non sono stati caricati correttamente.");
            document.getElementById('root').innerHTML = '<div class="text-center p-8 bg-red-100 text-red-700 rounded-xl max-w-lg mx-auto">Errore: Le librerie React/ReactDOM non sono state caricate. Controlla la tua connessione o le impostazioni di sicurezza.</div>';
        }
    </script>
</body>
</html>

